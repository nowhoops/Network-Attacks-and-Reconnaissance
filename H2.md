# H2
## Favorite color: purple
| specs | os | vm |
|---------|-------------|--------|
| (I5/8/256) | Kali | Kali on VirtualBox |
### Time **2025-10-25 / 19:07**


## Primary Color: Purple

## Background

- The goal of this task is to identify attack tools and avoid detection.

A)
## 1. Install Apache
sudo apt update
sudo apt upgrade -y
```bash
sudo apt install apache2 -y
```
### 2. Replace the default page
```bash
nano /var/www/html/index.html
```
- Pasted old web page that I had

### 3. Restart Apache
```bash
sudo systemctl restart apache2
```
4. Check the site from browser
<img width="699" height="643" alt="matrixwhoop" src="https://github.com/user-attachments/assets/b939c169-f4b9-4477-b876-e858af38eaf1" />

## 2. LOGs

-Find your log entry
```bash
sudo tail -n 10 /var/log/apache2/access.log

```

---

## Analysis of the Log Entry

| Part | Meaning |
|------|---------|
| `127.0.0.1` | Client IP address. This is the local machine (localhost). |
| `-` | Remote logname. Not used here, so it’s `-`. |
| `-` | Authenticated user. No login was required, so `-`. |
| `[02/Nov/2025:21:32:23 +0200]` | Date and time of the request, with timezone (+0200). |
| `"GET / HTTP/1.1"` | HTTP request line: method (GET), requested resource (`/` = homepage), and protocol (HTTP/1.1). |
| `200` | HTTP status code. 200 means the request was successful. |
| `1752` | Size of the response in bytes. The server sent 1752 bytes. |
| `"-"` | Referrer. No referring page, so it’s `-`. |
| `"Mozilla/5.0 (X11; Linux x86_64; rv:140.0) Gecko/20100101 Firefox/140.0"` | User-agent string. Indicates the browser (Firefox 140.0) and OS (Linux x86_64). |

---

## Summary

This log entry shows that the local machine (127.0.0.1) made an HTTP GET request to the homepage (`/`) of the Apache server. The server responded successfully with a 200 status code and sent 1752 bytes. No referrer page was recorded. The request came from Firefox 140.0 running on Linux x86_64.


### a) Apache Log
- Install the Apache web server on your local virtual machine. Browse your server over an unencrypted HTTP connection: `http://localhost`.
- Find the log entry corresponding to your page load. Analyze one such log entry, explaining all its components. (If Apache is unfamiliar to you, you can simply install it and test on the default web page. You don’t need to create your own website for this task.)

### b) Nmapped
- Perform a port scan of your web server using `localhost` and the `nmap -A` option.
- Explain the results. (Only port 80/tcp is necessary.)

### c) Scripts
- Which scripts were automatically enabled when you used the `-A` option? (This will show under the open port numbers, like `http-blah`, `http-blöh`, etc.)

### d) Traces in the Log
- Search for traces of the port scan in the web server logs (from NSE or Nmap Scripting Engine scripts in the scan). Do you find the word "nmap" in uppercase or lowercase? Explain the hits.
- What kind of searches or rules could you use to identify a port scan in another log, especially if it’s large and you can’t read all the lines?

### e) Wire Sharking
- Capture network traffic during the port scan with Wireshark. Note that `localhost` uses the "Loopback Adapter" or "lo".
- Save the `pcap` file. Search for entries that contain the word "nmap" and comment on them. You don’t need to analyze every part of each packet; a more general overview will suffice.

### f) Net Grep
- Capture network traffic with the `ngrep` command and show the entries where "nmap" appears.

### g) Agent
- Change the Nmap user-agent so that it looks like a regular web browser.

### h) Smaller Traces
- Perform the port scan again on the web server using the `localhost` address.
- Check both the Apache log and the captured network traffic. What changed when you altered the user-agent? Is the text "nmap" still present in the log?

### i) More Difficult: LoWeR ChEcK
- Remove the last instance of the "nmap" text from the script scan.
- Search for the found text in `/usr/share/nmap` and replace it with something else. Perform the port scan and ensure that "nmap" no longer appears in the Apache log or captured network traffic (both upper and lower case).
- **Note**: You may directly modify Lua scripts from `/usr/share/nmap` using `sudoedit`. Packaging the modified version is not required for this task.

### j) Optional, Difficult: Invisible, Invincible
- Search for another Nmap script that has the string "nmap" (uppercase or lowercase) in the network traffic.
- Modify Nmap’s code so that this string no longer appears in the network traffic.

## Tips

- These commands are from memory, and there may be some typos.
- **Apache Installation**:
  ```bash
  sudo apt-get update
  sudo apt-get install apache2
  sudo systemctl start apache2






source:
Bianco 2013: Pyramid of Pain.https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html

Caltagirone et al 2013: Diamond Model  https://www.threatintel.academy/wp-content/uploads/2020/07/diamond-model.pdf
