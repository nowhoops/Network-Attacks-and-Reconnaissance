# H1
## SNIFF SNIFF
| specs | os | vm |
|---------|-------------|--------|
| (I5/8/256/) | Kali | Kali on VirtualBox |
### Time **2025-10-25 / 20:31**



### X)
#### Summary
    Karvinen 2025: Wireshark - Getting Started
     

* installing wireshark with command
```bash
    sudo apt-get install wireshark
```
##### Using Wireshark

1. **Add your user to the group** that can use Wireshark.
2. **Pick a network interface** to monitor.
3. **Start capturing packets.**

### Troubleshooting

- If you cannot see any traffic, the **group settings** might be incorrect, or you may have selected the **wrong interface**.

        Karvinen 2025: Network Interface Names on Linux
  * "Network interface is almost a like a "network card". Except it's not necessarily a physical card."

| Prefix | Interface type |
|---------|----------------|
| **en** | Wired Ethernet |
| **wl** | WLAN, wireless local area network (WiFi) |
| **lo** | Loopback adapter |

* Check your interfaces with
```bash
ip a
ip route
```
### A)
- VM running on Oraclevm
- Had one problem when started the VM
```bash
00:00:01.583345 ERROR [COM]: aRC=VBOX_E_IPRT_ERROR (0x80bb0005) aIID={6ac83d89-6ee7-4e33-8ae6-b257b2e81be8} aComponent={ConsoleWrap} aText={The VBoxGuestPropSvc service call failed with the error VERR_HGCM_SERVICE_NOT_FOUND}, preserve=false aResultDetail=-2900
00:00:01.625349 ERROR [COM]: aRC=NS_ERROR_FAILURE (0x80004005) aIID={6ac83d89-6ee7-4e33-8ae6-b257b2e81be8} aComponent={ConsoleWrap} aText={VT-x is disabled in the BIOS for all CPU modes (VERR_VMX_MSR_ALL_VMX_DISABLED)}, preserve=false aResultDetail=-4028
```
  

- Now it works
 ---

### B)
- Disconnected network
<img width="589" height="441" alt="disconncet" src="https://github.com/user-attachments/assets/da17834d-bf92-406f-ac7d-9bccf8701531" />
 ---
 
### C)
#### I captured network traffic of my laptop being pinged from a VM running on the same laptop.
<img width="1841" height="237" alt="image" src="https://github.com/user-attachments/assets/1465ff0d-ad04-4840-8368-d2ecca466b4d" />

 ---
### D)
-Captured data (same data in H0)


### In text
| # | time (s) | source | Destination | Protocol | Lenght | Description |
|---|-----------|--------|--------|-------------|---------|---------|
| 64 | 3.014290612 | 10.202.7.247 | 54.73.126.92 | TLSv1.2 | 112 | Application Data |
| 65 | 3.310087818 | 10.202.7.247 | 54.73.126.92 | TCP | 112 | TCP Retransmission 52424 → 443 [PSH, ACK] |
| 66 | 3.320815312 | 54.73.126.92 | 10.202.7.247 | TLSv1.2 | 112 | Application Data |
| 67 | 3.320886392 | 10.202.7.247 | 54.73.126.92 | TCP | 66 | ACK |
| 68 | 3.375521011 | 54.73.126.92 | 10.202.7.247 | TCP | 78 | TCP Dup ACK |
| 69 | 22.408211028 | 10.202.7.247 | 10.202.7.86 | DNS | 65 | * |
| 70 | 22.408277313 | 10.202.7.247 | 10.202.7.86 | DNS | 65 | ** |
| 71 | 22.504009812 | 10.202.7.86 | 10.202.7.247 | DNS | 129 | Response: A records 108.156.22.54 jne. |
| 72 | 22.511981781 | 10.202.7.86 | 10.202.7.247 | DNS | 289 | Response: AAAA records (IPv6) |
| 73 | 22.513627903 | 2001:14bb:a7:dc2e:a... | 2600:9000:2368:0:b... | ICMPv6 | 118 | Echo (ping) request seq=1 |
| 74 | 22.839890502 | 2600:9000:2368:0:b... | 2001:14bb:a7:dc2e:a... | ICMPv6 | 118 | Echo (ping) reply seq=1 |
| 75 | 22.841054971 | 10.202.7.247 | 10.202.7.86 | DNS | 132 | Query PTR (IPv6 reverse lookup) |
| 76 | 22.880331054 | 10.202.7.86 | 10.202.7.247 | DNS | 203 | Response: No such name |
| 77 | 23.514191361 | 2001:14bb:a7:dc2e:a... | 2600:9000:2368:0:b... | ICMPv6 | 118 | Echo (ping) request seq=2 |


- **Link Layer** has Ethernet II and handles physical and data link communication including MAC addressing
<img width="631" height="129" alt="linklayer" src="https://github.com/user-attachments/assets/4b8e121a-8a51-4852-846d-4a5882f6bb02" />

-**Internet Layer** in this case it has ip4 header source and destination ip.
<img width="639" height="112" alt="internet" src="https://github.com/user-attachments/assets/6bc04257-589e-4d5b-b1ea-7bfb020e262e" />
- **Transport Layer**  Protocol: TCP  
<img width="630" height="112" alt="udp" src="https://github.com/user-attachments/assets/723eb369-5fee-4e44-ae2c-90f9d3c605ac" />
- **Application Layer** Protocol: DNS ( Domain Name System). Contians queries and responses for resolving domain names to ip's
<img width="629" height="114" alt="dns" src="https://github.com/user-attachments/assets/f32c6119-f5b9-4786-83a6-e09b8fb8d0c9" />


#### Summary 
| TCP/IP Layer           | Description                         | Example from capture                               |
|-----------------------|-----------------------------------|-------------------------------------------------------|
| Network Interface (Link) | Physical & MAC layer           | Ethernet II header with MAC addresses              |
| Internet              | Logical IP addressing & routing   | IPv4 packet with source and destination              |
| Transport             | Protocol for data transfer        | udp or tcp protocol with source and destination ports |
| Application           | Application data                  | DNS query and response messages carried inside UDP     |

 ---
### E)
- The capture file contains 8 different addresses.
- The protocols observed include ARP, TCP TLSv1.2–1.3, QUIC, and DNS.
- There are a total of 239 packets, with the largest packet having a length of 2757 bytes.
  <img width="933" height="105" alt="all" src="https://github.com/user-attachments/assets/4520f5e6-2cdb-4938-9ddc-451ca3ef9167" />

- They went to site terokarvinen.com
<img width="496" height="218" alt="tero" src="https://github.com/user-attachments/assets/f744fe02-eb37-4bb2-ac96-ac1d839f9b7c" />



### F)What is users NIC?
- Opened the pcap fiel
- Found source MAC address **52:54:00:2f:e1:e5** , **52:54:00:cc:d7:12**
<img width="1088" height="469" alt="mac" src="https://github.com/user-attachments/assets/61c2fdee-6598-4aa9-a373-f1785e483a33" />

- Could not find any vendor assigned with this mac
- What browser did user use?
  - found ja4 fingerprint: [JA4: t13d1715h2_5b57614c22b0_5c2c66f702b0]
  - Did a search from ja4 database (https://ja4db.com/application/Firefox%20121.0%20)
    <img width="559" height="384" alt="firefox" src="https://github.com/user-attachments/assets/56e65f26-d2f3-4ebe-b3e7-c1102ca3d2cb" />

### Sources
- Karvinen, Tero, Lari Iso-Anttila . 2025 *verkkoon-tunkeutuminen-ja-tiedustelu*.  
  [https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/](https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/)
- TCP/IP, [https://fi.wikipedia.org/wiki/TCP/IP](https://fi.wikipedia.org/wiki/TCP/IP)
- Karvinen, Tero, [https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/surfing-secure.pcap](https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/surfing-secure.pcap)
- Karvinen Tero, Wireshark - Getting Started [https://terokarvinen.com/wireshark-getting-started/](https://terokarvinen.com/wireshark-getting-started/)
- Karvinen Tero, Network Interface Names on Linux [https://terokarvinen.com/network-interface-linux/](https://terokarvinen.com/network-interface-linux/)
